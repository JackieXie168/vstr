<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>c2html for: ex_hello_world.h</title>
    <link rel="stylesheet" type="text/css" href="f_c.css">
  </head>
  <body>
     <h1>ex_hello_world.h</h1>
<pre class="c2html">
<span class="comment">/* *****************************************************************************
   Beg of hello_world.h header file which will be used in the following examples
   ****************************************************************************/</span>
#<span class="cppifndef">ifndef</span> HELLO_WORLD_H
#<span class="cppdefine">define</span> HELLO_WORLD_H

<span class="comment">/* ************************************************************************** */</span>
<span class="comment">/* headers: Vstr (and all supporting system headers), plus extra ones we need */</span>
<span class="comment">/* ************************************************************************** */</span>

#<span class="cppdefine">define</span> VSTR_COMPILE_INCLUDE 1 <span class="comment">/* make Vstr include it's system headers */</span>
#<span class="cppinclude">include</span> &lt;vstr.h&gt;
#<span class="cppinclude">include</span> &lt;errno.h&gt;
#<span class="cppinclude">include</span> &lt;err.h&gt; <span class="comment">/* BSD/Linux header see: man errx */</span>
#<span class="cppinclude">include</span> &lt;unistd.h&gt; <span class="comment">/* for STDOUT_FILENO */</span>

<span class="comment">/* ********************************* */</span>
<span class="comment">/* generic POSIX IO helper functions */</span>
<span class="comment">/* ********************************* */</span>

#<span class="cppdefine">define</span> IO_OK    <span class="num0">0</span>
<span class="comment">/* the missing values will be explained later in the tutorial... */</span>
#<span class="cppdefine">define</span> IO_NONE  3

<span class="static">static</span> <span class="int">int</span> io_put(<span class="vstrbase">Vstr_base</span> *io_w, <span class="int">int</span> fd)
{ <span class="comment">/* assumes POSIX */</span>
  <span class="if">if</span> (!io_w-&gt;len)
    <span class="return">return</span> (IO_NONE);
  
  <span class="if">if</span> (!vstr_sc_write_fd(io_w, 1, io_w-&gt;len, fd, <span class="null">NULL</span>))
  {
    <span class="if">if</span> (<span class="errno">errno</span> != EINTR)
      <span class="err">err</span>(<span class="exitfail">EXIT_FAILURE</span>, <span class="str">"write"</span>);
  }

  <span class="return">return</span> (IO_OK);
}

<span class="comment">/* ************************ */</span>
<span class="comment">/* generic helper functions */</span>
<span class="comment">/* ************************ */</span>

<span class="comment">/* hello world init function, init library and create a string */</span>
<span class="static">static</span> <span class="vstrbase">Vstr_base</span> *hw_init(<span class="void">void</span>)
{
  <span class="vstrbase">Vstr_base</span> *s1 = <span class="null">NULL</span>;

  <span class="if">if</span> (!vstr_init())
    <span class="errno">errno</span> = ENOMEM, <span class="err">err</span>(<span class="exitfail">EXIT_FAILURE</span>, <span class="str">"init"</span>);

  <span class="if">if</span> (!(s1 = vstr_make_base(<span class="null">NULL</span>))) <span class="comment">/* create an empty string */</span>
    <span class="errno">errno</span> = ENOMEM, <span class="err">err</span>(<span class="exitfail">EXIT_FAILURE</span>, <span class="str">"Create string"</span>);

  <span class="return">return</span> (s1);
}

<span class="comment">/* hello world exit function, cleanup what was allocated in hw_init() */</span>
<span class="static">static</span> <span class="int">int</span> hw_exit(<span class="vstrbase">Vstr_base</span> *s1)
{
  vstr_free_base(s1);

  vstr_exit();

  <span class="return">return</span> (<span class="exitsucs">EXIT_SUCCESS</span>);
}

#<span class="cppendif">endif</span>
<span class="comment">/* *****************************************************************************
   End of hello_world.h header file which will be used in the following examples
   ****************************************************************************/</span>
</pre>
<!-- C to html convertion of ex_hello_world.h -->
<!--   done on Sun May  9 02:29:54 2004
 -->
<!--   done by ex_highlight -->

  </body>
</html>