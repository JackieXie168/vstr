<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>c2html for: ex_hello_world.c</title>
    <link rel="stylesheet" type="text/css" href="f_c.css">
  </head>
  <body>
     <h1>ex_hello_world.c</h1>
<pre class="c2html">
<span class="comment">/* hello world - Self contained, using a single piece of data at
 *               initialisation time (no data copying) */</span> 

#<span class="cppdefine">define</span> VSTR_COMPILE_INCLUDE 1
#<span class="cppinclude">include</span> &lt;vstr.h&gt;
#<span class="cppinclude">include</span> &lt;errno.h&gt;  <span class="comment">/* errno variable */</span>
#<span class="cppinclude">include</span> &lt;err.h&gt;    <span class="comment">/* BSD/Linux header see: man errx */</span>
#<span class="cppinclude">include</span> &lt;unistd.h&gt; <span class="comment">/* for STDOUT_FILENO */</span>

<span class="int">int</span> main(<span class="void">void</span>)
{
  <span class="vstrbase">Vstr_base</span> *s1 = <span class="null">NULL</span>;

  <span class="if">if</span> (!vstr_init()) <span class="comment">/* initialize the library */</span>
    <span class="err">err</span>(<span class="exitfail">EXIT_FAILURE</span>, <span class="str">"init"</span>);

  <span class="comment">/* create a string with data */</span>
  <span class="if">if</span> (!(s1 = vstr_dup_cstr_buf(<span class="null">NULL</span>, <span class="str">"Hello World\n"</span>)))
    <span class="err">err</span>(<span class="exitfail">EXIT_FAILURE</span>, <span class="str">"Create string"</span>);

  <span class="comment">/* output the data to the user --
   *    assumes POSIX, assumes blocking IO but should work without */</span>
  <span class="while">while</span> (s1-&gt;len)
    <span class="if">if</span> (!vstr_sc_write_fd(s1, 1, s1-&gt;len, <span class="stdout">STDOUT_FILENO</span>, <span class="null">NULL</span>))
    {
      <span class="if">if</span> ((<span class="errno">errno</span> != EAGAIN) &amp;&amp; (<span class="errno">errno</span> != EINTR))
        <span class="err">err</span>(<span class="exitfail">EXIT_FAILURE</span>, <span class="str">"write"</span>);
    }

  <span class="comment">/* cleanup allocated resources */</span>
  vstr_free_base(s1);

  vstr_exit();

  <span class="exit">exit</span> (<span class="exitsucs">EXIT_SUCCESS</span>);
}
</pre>
<!-- C to html convertion of ex_hello_world.c -->
<!--   done on Sun May  9 02:29:53 2004
 -->
<!--   done by ex_highlight -->

  </body>
</html>